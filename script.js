const smiskiData = {
  "Series 1": {
    cover: "Series_1/peeking.PNG",
    figures: [
      { name: "Hugging Knees", img: "Series_1/hugging_knees.PNG" },
      { name: "Sitting", img: "Series_1/sitting.PNG" },
      { name: "Looking Back", img: "Series_1/looking_back.PNG" },
      { name: "Lounging", img: "Series_1/lounging.PNG" },
      { name: "Hiding", img: "Series_1/hiding.PNG" },
      { name: "Peeking", img: "Series_1/peeking.PNG" },
      { name: "Little Smiski Lifting", img: "https://www.smiski.com/assets/img/series/living/sleeping.png" },
      { name: "Little Smiski Peeking", img: "https://www.smiski.com/assets/img/series/living/sleeping.png" },
      { name: "Little Smiski Hugging", img: "https://www.smiski.com/assets/img/series/living/secret.png" },
      { name: "Secret Scream", img: "https://www.smiski.com/assets/img/series/living/secret.png" },
    ],
  },
  "Series 2": {
    cover: "Series_2/pushing.PNG",
    figures: [
      { name: "Kneeling", img: "Series_2/kneeling.PNG" },
      { name: "Climbing", img: "Series_2/climbing.PNG" },
      { name: "Daydreaming", img: "Series_2/daydreaming.PNG" },
      { name: "Pushing", img: "Series_2/pushing.PNG" },
      { name: "Peeking", img: "Series_2/peeking.PNG" },
      { name: "Listening", img: "Series_2/listening.PNG" },
    ],
  },
  "Series 3": {
    cover: "Series_3/handstand.PNG",
    figures: [
      { name: "Bridge", img: "Series_3/bridge.PNG" },
      { name: "Peeking", img: "Series_3/peeking.PNG" },
      { name: "Climbing", img: "Series_3/climbing.PNG" },
      { name: "Little", img: "Series_3/little.PNG" },
      { name: "Hiding", img: "Series_3/hiding.PNG" },
      { name: "Handstand", img: "Series_3/handstand.PNG" },
    ],
  },
  "Series 4": {
    cover: "Series_4/sneaking.PNG",
    figures: [
      { name: "Sneaking", img: "Series_4/sneaking.PNG" },
      { name: "Scared", img: "Series_4/scared.PNG" },
      { name: "Relaxing", img: "Series_4/relaxing.PNG" },
      { name: "Lazy", img: "Series_4/lazy.PNG" },
      { name: "Stuck", img: "Series_4/stuck.PNG" },
      { name: "Defeated", img: "Series_4/defeated.PNG" },
    ],
  },
  "Bath_Series": {
    cover: "Bath_Series/shampooing.PNG",
    figures: [
      { name: "Shampooing", img: "Bath_Series/shampooing.PNG" },
      { name: "Not Looking", img: "Bath_Series/not-looking.PNG" },
      { name: "Scrubbing", img: "Bath_Series/scrubbing.PNG" },
      { name: "With Duck", img: "Bath_Series/with-duck.PNG" },
      { name: "Dazed", img: "Bath_Series/dazed.PNG" },
      { name: "Looking", img: "Bath_Series/looking.PNG" },
    ],
  },
  "Toilet_Series": {
    cover: "Toilet_Series/squatting.PNG",
    figures: [
      { name: "Peek-A-Boo", img: "Toilet_Series/peek-a-boo.PNG" },
      { name: "Little (Smelly)", img: "Toilet_Series/little-smelly.PNG" },
      { name: "Squatting", img: "Toilet_Series/squatting.PNG" },
      { name: "Helping Out", img: "Toilet_Series/helping-out.PNG" },
      { name: "Resting", img: "Toilet_Series/resting.PNG" },
      { name: "Holding In", img: "Toilet_Series/holding-in.PNG" },
    ],
  },
  "Living_Series": {
    cover: "Living_Series/daydreaming.PNG",
    figures: [
      { name: "Daydreaming", img: "Living_Series/daydreaming.PNG" },
      { name: "Playing", img: "Living_Series/playing.PNG" },
      { name: "Hiding", img: "Living_Series/hiding.PNG" },
      { name: "Nap Time", img: "Living_Series/nap-time.PNG" },
      { name: "Thinking", img: "Living_Series/thinking.PNG" },
      { name: "Lifting", img: "Living_Series/lifting.PNG" },
    ],
  },
  "Bed_Series": {
    cover: "Bed_Series/before-rest.PNG",
    figures: [
      { name: "Before Rest", img: "Bed_Series/before-rest.PNG" },
      { name: "Sleepy", img: "Bed_Series/sleepy.PNG" },
      { name: "Co-Sleeping", img: "Bed_Series/co-sleeping.PNG" },
      { name: "Reading", img: "Bed_Series/reading.PNG" },
      { name: "Good Night", img: "Bed_Series/goodnight.PNG" },
      { name: "Crying", img: "Bed_Series/crying.PNG" },
    ],
  },
  "Yoga_Series": {
    cover: "Yoga_Series/lotus-pose.PNG",
    figures: [
      { name: "Lotus Pose", img: "Yoga_Series/lotus-pose.PNG" },
      { name: "Twist Pose", img: "Yoga_Series/twist-pose.PNG" },
      { name: "Spinal Twist", img: "Yoga_Series/spinal-twist.PNG" },
      { name: "Triangle Pose", img: "Yoga_Series/triangle-pose.PNG" },
      { name: "Shoulderstand", img: "Yoga_Series/shoulderstand.PNG" },
      { name: "Ship Pose", img: "Yoga_Series/ship-pose.PNG" },
    ],
  },
  "Cheer_Series": {
    cover: "Cheer_Series/dancing.PNG",
    figures: [
      { name: "Marching", img: "Cheer_Series/marching.PNG" },
      { name: "On Drums", img: "Cheer_Series/on-drums.PNG" },
      { name: "On Your Side", img: "Cheer_Series/on-your-side.PNG" },
      { name: "Dancing", img: "Cheer_Series/dancing.PNG" },
      { name: "Little Cheerleading", img: "Cheer_Series/little-cheerleading.PNG" },
      { name: "Cheering", img: "Cheer_Series/cheering.PNG" },
    ],
  },
  "Museum_Series": {
    cover: "Museum_Series/pearl-earring.PNG",
    figures: [
      { name: "The Source", img: "Museum_Series/the-source.PNG" },
      { name: "Fuzin & Raijin", img: "Museum_Series/fuzin-raijin.PNG" },
      { name: "Bacchus", img: "Museum_Series/bacchus.PNG" },
      { name: "Velaâ€™zquez", img: "Museum_Series/velazquez.PNG" },
      { name: "Dali", img: "Museum_Series/dali.PNG" },
      { name: "Pearl Earring", img: "Museum_Series/pearl-earring.PNG" },
    ],
  },
  "@_Work_Series": {
    cover: "@_Work_Series/researching.PNG",
    figures: [
      { name: "Approving", img: "@_Work_Series/approving.PNG" },
      { name: "Researching", img: "@_Work_Series/researching.PNG" },
      { name: "Presenting", img: "@_Work_Series/presenting.PNG" },
      { name: "Good Idea", img: "@_Work_Series/good-idea.PNG" },
      { name: "On the Road", img: "@_Work_Series/on-the-road.PNG" },
      { name: "Little Group Think", img: "@_Work_Series/little-group-think.PNG" },
    ],
  },
  "Dressing_Series": {
    cover: "Dressing_Series/sweater.PNG",
    figures: [
      { name: "Underpants", img: "Dressing_Series/underpants.PNG" },
      { name: "Struggling", img: "Dressing_Series/struggling.PNG" },
      { name: "Loose Pants", img: "Dressing_Series/loose-pants.PNG" },
      { name: "Putting On Socks", img: "Dressing_Series/putting-on-socks.PNG" },
      { name: "Sweater", img: "Dressing_Series/sweater.PNG" },
      { name: "Tight Pants", img: "Dressing_Series/tight-pants.PNG" },
    ],
  },
  "Exercising_Series": {
    cover: "Exercising_Series/hoop.PNG",
    figures: [
      { name: "Doing Crunches", img: "Exercising_Series/doing-crunches.PNG" },
      { name: "Aerobics", img: "Exercising_Series/aerobics.PNG" },
      { name: "Little Balance", img: "Exercising_Series/little-balance.PNG" },
      { name: "Dumbbell", img: "Exercising_Series/dumbbell.PNG" },
      { name: "Hoop", img: "Exercising_Series/hoop.PNG" },
      { name: "Stretch", img: "Exercising_Series/stretch.PNG" },
    ],
  },
  "Moving_Series": {
    cover: "Moving_Series/balancing-boxes.PNG",
    figures: [
      { name: "Carrying Ladder", img: "Moving_Series/carrying-ladder.PNG" },
      { name: "Balancing Boxes", img: "Moving_Series/balancing-boxes.PNG" },
      { name: "Decorating", img: "Moving_Series/decorating.PNG" },
      { name: "Little Teamwork", img: "Moving_Series/little-teamwork.PNG" },
      { name: "Green Thumb", img: "Moving_Series/green-thumb.PNG" },
      { name: "Falling Down", img: "Moving_Series/falling-down.PNG" },
    ],
  },
  "Hippers_Series": {
    cover: "Hippers_Series/looking-out.PNG",
    figures: [
      { name: "On His Smartphone", img: "Hippers_Series/on-his-smartphone.PNG" },
      { name: "Trying to Climb", img: "Hippers_Series/trying-to-climb.PNG" },
      { name: "Looking Out", img: "Hippers_Series/looking-out.PNG" },
      { name: "Sticking", img: "Hippers_Series/sticking.PNG" },
      { name: "Dozing", img: "Hippers_Series/dozing.PNG" },
      { name: "Upside Down", img: "Hippers_Series/upside-down.PNG" },
    ],
  },
  "Sunday_Series": {
    cover: "Sunday_Series/paper-airplane.PNG",
    figures: [
      { name: "Blowing Bubbles", img: "Sunday_Series/blowing-bubbles.PNG" },
      { name: "Paper Airplane", img: "Sunday_Series/paper-airplane.PNG" },
      { name: "Sunbathing", img: "Sunday_Series/sunbathing.PNG" },
      { name: "Sing-Along", img: "Sunday_Series/sing-along.PNG" },
      { name: "Skateboarding", img: "Sunday_Series/skateboarding.PNG" },
      { name: "Gardening", img: "Sunday_Series/gardening.PNG" },
    ],
  },
  "Birthday_Series": {
    cover: "Birthday_Series/birthday-message.PNG",
    figures: [
      { name: "Giving a Bouquet", img: "Birthday_Series/giving-bouquet.PNG" },
      { name: "Wrapped Up", img: "Birthday_Series/wrapped-up.PNG" },
      { name: "Popping Confetti", img: "Birthday_Series/popping-confetti.PNG" },
      { name: "Birthday Message", img: "Birthday_Series/birthday-message.PNG" },
      { name: "Little Decorating", img: "Birthday_Series/little-decorating.PNG" },
      { name: "Tasting", img: "Birthday_Series/tasting.PNG" },
    ],
  },
};

// ---------------- Homepage Logic ----------------
if (document.body.classList.contains("home-page")) {
  const container = document.getElementById("series-container");
  const search = document.getElementById("search");
  const clearAllBtn = document.getElementById("clear-all-btn");

  // Render series cards
  function renderSeries(filter = "") {
    container.innerHTML = "";

    Object.entries(smiskiData)
      .filter(([seriesName]) =>
        seriesName.toLowerCase().includes(filter.toLowerCase())
      )
      .forEach(([seriesName, seriesData]) => {
        const collected = JSON.parse(localStorage.getItem(seriesName)) || [];
        const total = seriesData.figures.length;
        const percent = Math.round((collected.length / total) * 100);

        // Wrapper for card + tracker
        const wrapper = document.createElement("div");
        wrapper.className = "series-wrapper";

        // Series card (links to series page)
        const card = document.createElement("a");
        card.href = `series.html?name=${encodeURIComponent(seriesName)}`;
        card.className = "series-card";
        card.innerHTML = `
          <div class="image-wrapper">
            <img src="${seriesData.cover}" alt="${seriesName}">
            <h2 class="series-title">${seriesName}</h2>
          </div>
        `;

        // Tracker (progress bar + count)
        const tracker = document.createElement("div");
        tracker.className = "series-tracker";
        tracker.innerHTML = `
          <div class="progress-bar">
            <div class="progress-fill" style="width:${percent}%"></div>
          </div>
          <span class="progress-count">${collected.length}/${total}</span>
        `;

        wrapper.appendChild(card);
        wrapper.appendChild(tracker);
        container.appendChild(wrapper);
      });

    updateOverallProgress(); // Update overall tracker after rendering
  }

  // Overall progress tracker
  function updateOverallProgress() {
    let totalCollected = 0;
    let totalFigures = 0;

    Object.entries(smiskiData).forEach(([seriesName, seriesData]) => {
      const collected = JSON.parse(localStorage.getItem(seriesName)) || [];
      totalCollected += collected.length;
      totalFigures += seriesData.figures.length;
    });

    const percent = totalFigures > 0 ? Math.round((totalCollected / totalFigures) * 100) : 0;
    const overallProgress = document.getElementById("overall-progress");

    if (overallProgress) {
      overallProgress.querySelector(".progress-fill").style.width = percent + "%";
      overallProgress.querySelector(".progress-count").textContent = `${totalCollected}/${totalFigures}`;
    }
  }

  // Initial render
  renderSeries();

  // Search filter
  search.addEventListener("input", (e) => {
    renderSeries(e.target.value);
  });

  // Clear all button
  clearAllBtn.addEventListener("click", () => {
    if (confirm("Are you sure you want to clear ALL collected Smiskis?")) {
      Object.keys(localStorage).forEach(key => {
        if (smiskiData[key]) localStorage.removeItem(key);
      });
      renderSeries();           // re-render the series cards
      updateOverallProgress();  // update the overall tracker
    }
  });
}

// ---------------- Series Page Logic ----------------
if (document.body.classList.contains("series-page")) {
  const params = new URLSearchParams(window.location.search);
  const seriesName = params.get("name");
  const title = document.getElementById("series-title");
  const container = document.getElementById("smiski-container");
  const clearBtn = document.getElementById("clear-btn");

  const series = smiskiData[seriesName];
  let collected = JSON.parse(localStorage.getItem(seriesName)) || [];

  title.textContent = seriesName;

  function renderFigures() {
    container.innerHTML = "";

    series.figures.forEach(f => {
      const isCollected = collected.includes(f.name);

      const card = document.createElement("div");
      card.className = "smiski-card";
      if (isCollected) card.classList.add("collected");

      card.innerHTML = `
        <label class="checkbox-wrapper">
          <input type="checkbox" ${isCollected ? "checked" : ""}>
          <span class="checkmark"></span>
        </label>
        <img src="${f.img}" alt="${f.name}">
        <p>${f.name}</p>
      `;

      const checkbox = card.querySelector("input[type='checkbox']");
      checkbox.addEventListener("change", () => {
        if (checkbox.checked) {
          if (!collected.includes(f.name)) collected.push(f.name);
          card.classList.add("collected");
        } else {
          collected = collected.filter(n => n !== f.name);
          card.classList.remove("collected");
        }
        localStorage.setItem(seriesName, JSON.stringify(collected));
      });

      container.appendChild(card);
    });
  }

  renderFigures();

  clearBtn.addEventListener("click", () => {
    if (confirm("Clear all collected Smiskis for this series?")) {
      collected = [];
      localStorage.removeItem(seriesName);
      renderFigures();
    }
  });

}



